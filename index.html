<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>Quiz Grupo Garbo</title>
  <style>
    :root { --azul:#1e40ff; --verde:#9bd438; --txt:#fff; --radius:16px; }
    * { box-sizing: border-box; margin: 0; padding: 0; }

    html, body {
      width:100%; height:100%;
      font-family: 'Poppins', system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      color: var(--txt);
      background: linear-gradient(135deg, #000 0%, var(--verde) 60%, var(--azul) 100%);
      overflow-x: hidden;
    }
    body {
      min-height: 100dvh;
      padding: 20px;
      display:flex; align-items:center; justify-content:center;
      overflow-y: auto; -webkit-overflow-scrolling: touch;
    }

    /* ===== Container com efeito vidro ===== */
    .container{
      background: rgba(20, 20, 20, 0.45);
      backdrop-filter: blur(12px) saturate(160%);
      -webkit-backdrop-filter: blur(12px) saturate(160%);
      border: 1px solid rgba(255, 255, 255, 0.18);
      border-radius: var(--radius);
      box-shadow: 0 0 25px rgba(155,212,56,0.25), inset 0 0 20px rgba(255,255,255,0.03);
      padding: clamp(18px, 3.5vw, 30px);
      width: min(96vw, 920px);
      display:flex; flex-direction:column; align-items:center; text-align:center;
      animation: fadeIn 0.6s ease;
    }
    @keyframes fadeIn { from{opacity:0; transform:scale(.97)} to{opacity:1; transform:scale(1)} }

    .logo{
      width: clamp(160px, 35vw, 240px);
      margin-bottom: clamp(12px, 2.5vw, 16px);
      filter: drop-shadow(0 0 10px rgba(30,64,255,0.7));
    }
    h1{
      font-size: clamp(1.2rem, 2.5vw + 0.8rem, 1.6rem);
      margin-bottom: clamp(12px, 2.5vw, 20px);
      background: linear-gradient(90deg, var(--verde), var(--azul));
      -webkit-background-clip:text; -webkit-text-fill-color:transparent;
      text-transform: uppercase; letter-spacing: 1.2px; font-weight:700;
    }

    /* ===== Inputs largos + vidro ===== */
    #formIdentificacao, #telaPergunta { width:100%; max-width: 820px; margin: 0 auto; }
    .input-group{
      width:95%; max-width:800px; margin: 0 auto clamp(12px,2.2vw,16px);
      display:flex; flex-direction:column; text-align:left;
    }
    .input-group label{ margin-bottom:6px; font-size:clamp(.9rem,1.8vw,1rem); opacity:.85; }
.input-group input,
.input-group select {
  width:100%;
  padding: clamp(12px,2vw,14px);
  border-radius:12px;
  font-size:clamp(.95rem,1.8vw,1rem);
  color:#fff;
  background: rgba(255,255,255,0.08);
  border: 1px solid rgba(255,255,255,0.2);
  box-shadow: inset 0 0 5px rgba(0,0,0,0.5);
  outline:none;
  transition: all .3s ease;
  appearance: none; /* remove o estilo nativo */
}

.input-group select:focus {
  border-color: var(--verde);
  box-shadow: 0 0 12px rgba(155,212,56,0.4), inset 0 0 6px rgba(155,212,56,0.2);
  background: rgba(255,255,255,0.12);
}

    .input-group input:focus{
      border-color: var(--verde);
      box-shadow: 0 0 12px rgba(155,212,56,0.4), inset 0 0 6px rgba(155,212,56,0.2);
      background: rgba(255,255,255,0.12);
    }
  
    .input-group select {
  color: #000; /* letra preta no campo */
  background: rgba(255,255,255,0.9); /* fundo claro */
}

.input-group select option {
  color: #000; /* letra preta nas opções */
  background: #fff; /* fundo branco nas opções */
}


    .btn{
      width:95%; max-width:800px; margin: clamp(10px,2.5vw,16px) auto 0;
      padding: clamp(12px,2vw,14px);
      border:none; border-radius:10px; min-height:44px;
      background: linear-gradient(90deg, var(--verde), var(--azul));
      color:#fff; font-weight:600; font-size:clamp(.9rem,1.8vw,1rem);
      text-transform:uppercase; letter-spacing:.8px; cursor:pointer;
      transition:.3s ease; box-shadow: 0 4px 12px rgba(30,64,255,0.25);
    }
    .btn:hover{ background: linear-gradient(90deg, var(--azul), var(--verde)); transform: translateY(-1px); }

    #perguntaTexto{ font-size:clamp(1rem,2.2vw,1.1rem); margin:clamp(12px,2.5vw,18px) 4px; line-height:1.4; }

    .options{
      list-style:none; padding:0; width:100%;
      max-height: 46vh; overflow:auto; -webkit-overflow-scrolling:touch;
      margin-bottom: clamp(10px,2vw,14px);
    }
    .options li{
      margin: 8px 0; padding: clamp(10px,2.2vw,12px);
      border-radius:10px; cursor:pointer;
      background: rgba(255,255,255,0.06);
      border:2px solid var(--azul);
      transition:.2s ease; font-size:clamp(.92rem,1.8vw,.98rem);
      min-height:44px; display:flex; align-items:center;
    }
    .options li:hover{ background: rgba(30,64,255,0.18); }
    .options li.correct{ background: rgba(0,255,0,0.25); border-color:#00ff7f; }
    .options li.wrong{ background: rgba(255,0,0,0.25); border-color:#ff4747; }

    #msgResultado{ margin-top: clamp(10px,2vw,16px); font-size:clamp(.95rem,1.8vw,1rem); font-weight:600; min-height:1.2em; text-align:center; }

    .top-buttons{ position:absolute; left:-56px; top: 120px; display:flex; gap:10px; z-index:5; flex-direction:column; }
    .top-buttons .btn{ width:44px; min-width:44px; padding:10px; border-radius:10px; }

    /* ===== Fogos refinados ===== */
    #explosaoFogos{
      position: fixed; top:50%; left:50%;
      transform: translate(-50%, -50%) scale(0); opacity:0; pointer-events:none;
      width: clamp(120px, 30vw, 220px); height: clamp(120px, 30vw, 220px); z-index:5;
      filter: drop-shadow(0 0 12px rgba(255,255,255,0.4)) blur(2px) saturate(130%);
      transition: transform .3s ease, opacity .3s ease;
    }
    #explosaoFogos.ativo{ animation: fogosBoom 3.5s ease-out forwards; }
    @keyframes fogosBoom{
      0%{ transform:translate(-50%,-50%) scale(.2); opacity:0; }
      20%{ transform:translate(-50%,-50%) scale(1); opacity:.9; }
      60%{ transform:translate(-50%,-50%) scale(.9); opacity:.7; }
      100%{ transform:translate(-50%,-50%) scale(0); opacity:0; }
    }

    .efeitoTela{ position:fixed; inset:0; pointer-events:none; opacity:0; transition:opacity .4s ease; z-index:1; }
    .efeitoTela.ativo{ opacity:1; }
    .efeitoTela.chuva{ background-image:url('chuva.png'); background-size:cover; background-repeat:repeat; animation: chuvaAnim 6s linear infinite; }
    @keyframes chuvaAnim{ 0%{background-position:0 0;} 100%{background-position:0 100%;} }

    @media (max-width: 480px){ .container{ width:94vw; } .top-buttons{ left:8px; top:8px; flex-direction:row; } }
    @media (max-width: 360px){ .logo{ width:150px; } }
  </style>
</head>
<body>
  <!-- Efeitos -->
  <img src="fogos.png" id="explosaoFogos" alt="Fogos" />
  <div id="efeitoTela" class="efeitoTela"></div>

  <!-- Botões utilitários -->
  <div class="top-buttons">
    <button id="btnDownload" class="btn" title="Baixar CSV">⬇</button>
    <button id="btnLimpar" class="btn" title="Limpar dados locais">✖</button>
  </div>

  <!-- Card -->
  <div class="container">
    <img src="LOGO GARBO_Prancheta 1.png" alt="Grupo Garbo" class="logo" />
    <h1>Quiz Interativo</h1>

    <!-- Form -->
    <div id="formIdentificacao">
      <div class="input-group"><label>Nome:</label><input type="text" id="nome" required></div>
<div class="input-group">
  <label>Setor:</label>
  <select id="setor" required>
    <option value="" disabled selected>Selecione o setor</option>
    <option value="Financeiro">Financeiro</option>
    <option value="FVG">FVG</option>
    <option value="GIPT">GIPT</option>
    <option value="Loja">Loja</option>
    <option value="Logistica">Logística</option>
    <option value="RH">RH</option>
    <option value="Suprimentos">Suprimentos</option>
    <option value="VD">VD</option>
  </select>
</div>

<div class="input-group">
  <label>Cidade:</label>
  <select id="cidade" required>
    <option value="" disabled selected>Selecione a cidade</option>
    <option value="BARREIRINHAS">Barreirinhas</option>
    <option value="CHAPADINHA">Chapadinha</option>
    <option value="CODÓ">Codó</option>
    <option value="COROATÁ">Coroatá</option>
    <option value="ITAPECURU">Itapecuru</option>
    <option value="MIRANDA">Miranda</option>
    <option value="PERITORÓ">Peritoró</option>
    <option value="ROSÁRIO">Rosário</option>
    <option value="SANTA RITA">Santa Rita</option>
    <option value="TUTÓIA">Tutóia</option>
    <option value="URBANO SANTOS">Urbano Santos</option>
    <option value="VARGEM GRANDE">Vargem Grande</option>
  </select>
</div>


      <button id="btnIniciar" class="btn">Iniciar Quiz</button>
    </div>

    <!-- Pergunta -->
    <div id="telaPergunta" style="display:none;">
      <div id="perguntaTexto"></div>
      <ul id="optionsList" class="options"></ul>
      <div id="msgResultado"></div>
      <button id="btnVoltar" class="btn" style="display:none;">Voltar</button>
    </div>
  </div>

  <script>
    /* ====== URL do seu Web App (Apps Script) ====== */
    const SHEETS_WEBAPP_URL = 'https://script.google.com/macros/s/AKfycbwIPX-KLKOzp7mUkOy59N2vxozzGGuAb5EKGRa-kOBbzTbwR9PJvq79WQRUuPLBHEH17Q/exec';

    /* ====== Perguntas embutidas ====== */
    const perguntas = [
      { p:"Em que ano foi fundada a marca O Boticário?", A:"1972", B:"1977", C:"1980", D:"1984", correta:"B" },
      { p:"Qual é o slogan atual do O Boticário?", A:"Beleza que encanta", B:"O Boticário, onde tem amor tem beleza", C:"Viva sua beleza", D:"Beleza para todos", correta:"B" },
      { p:"Qual foi o primeiro produto lançado pelo O Boticário?", A:"Perfume Malbec", B:"Creme Lily", C:"Álcool de Alfazema", D:"Colônia Floratta", correta:"C" },
      { p:"O Boticário está presente em quantos países atualmente?", A:"5", B:"10", C:"15", D:"Mais de 15", correta:"D" },
      { p:"Além de O Boticário, quais outras marcas fazem parte do Grupo Boticário?", A:"Avon, Natura, Jequiti", B:"Eudora, Quem Disse Berenice?, Vult, O.U.i, Beleza na Web", C:"Mary Kay, Eudora, Nivea", D:"Quem Disse Berenice?, Avon, Vult", correta:"B" },
      { p:"Quantos pontos de venda o Grupo Garbo possui atualmente?", A:"12", B:"14", C:"15", D:"20", correta:"C" },
      { p:"Qual é o grito de guerra do Grupo Garbo?", A:"Vamos juntos crescer, Grupo Garbo vai vencer!", B:"Respire Resultado e faça acontecer, aqui é Grupo Garbo e a nossa meta é crescer", C:"Respire IAF e faça acontecer, aqui é Grupo Garbo e a nossa meta é crescer", D:"Somos Garbo, somos Diamante", correta:"C" },
      { p:"O que precisamos para alcançar o título de Diamante no Grupo Garbo?", A:"Apenas vender mais produtos", B:"Garantir alta performance em indicadores (IAF), engajamento da equipe e excelência nas lojas", C:"Abrir novas lojas", D:"Focar apenas em promoções", correta:"B" },
      { p:"Qual dessas iniciativas envolve todos os colaboradores do Grupo Garbo?", A:"REMAR – Reunião Mensal de Avaliação de Resultados", B:"Comitê de Gente e Cultura", C:"PCOF – Plano de Controle Operacional Financeiro", D:"Conselho de Liderança", correta:"B" },
      { p:"Qual título o Grupo Garbo busca conquistar até o final do ano?", A:"Ouro", B:"Prata", C:"Diamante", D:"Rubi", correta:"C" },
      { p:"O que é o Grupo Garbo dentro da rede do Grupo Boticário?", A:"Líder de franquia", B:"Contratado", C:"Representante", D:"Franqueado", correta:"D" },
      { p:"O que significa a sigla CP?", A:"Código principal", B:"Central principal", C:"Central de prontidão", D:"Código pai", correta:"D" },
      { p:"Quais são as principais marcas do Grupo Boticário que comercializamos?", A:"Vult, O.U.i, Beleza na Web", B:"Truss, O Boticário, Eudora e QDB", C:"Vult, O Boticário, Eudora e Oui", D:"O Boticário, Eudora, Oui e QDB", correta:"D" },
      { p:"Quais são as categorias de revendedores Pedras Preciosas (VIPs)?", A:"Diamante e Esmeralda", B:"Platina, Esmeralda e Diamante", C:"Ouro, Prata e Rubi", D:"Rubi, Esmeralda e Diamante", correta:"D" },
      { p:"Onde fica o ponto de apoio físico para os revendedores atendidos pelo Grupo Garbo?", A:"Urbano Santos, Chapadinha, Itapecuru, Santa Rita, Barreirinhas", B:"Rosário, Codo, Santa Rita, Vargem Grande", C:"Brejo, Tutoia, Chapadinha, Itapecuru, Santa Rita, Barreirinhas, Codo, Santa Rita, Vargem", D:"Tutoia, Chapadinha, Itapecuru, Santa Rita, Barreirinhas, Codo, Santa Rita, Vargem Grande", correta:"D" },
      { p:"O que significa IAF?", A:"Instrumento de Aceleração do Franqueado", B:"Indicadores de Alta Performance", C:"Instrumento de Aceleração do Futuro", D:"Indicadores para Franqueados", correta:"C" },
      { p:"O que significa VD dentro da operação do Grupo Boticário?", A:"Venda para revendedores", B:"Revenda para revendedora", C:"Venda domiciliar", D:"Venda direta", correta:"D" },
      { p:"Qual é a importância da precificação correta nas vitrines e kits para a auditoria e para o cliente final?", A:"Só importa em períodos de promoção", B:"Não influencia na experiência do cliente", C:"Fundamental para garantir confiança para o cliente, reforçando a credibilidade da marca; em auditoria são indicadores de padronização, organização e conformidade", D:"Desnecessária o cliente pode usar o aplicativo.", correta:"C" },
      { p:"Qual é o principal objetivo do Instrumento de Aceleração do Futuro (IAF)?", A:"Avaliar apenas o faturamento dos revendedores", B:"Padronizar o atendimento e acelerar resultados da operação", C:"Organizar somente os estoques da loja", D:"Controlar horários de entrada e saída dos colaboradores", correta:"B" },
      { p:"Por que é importante manter o ponto de apoio físico bem estruturado para os revendedores?", A:"Apenas para guardar produtos sem organização", B:"Para facilitar o atendimento, treinamentos e retirada de pedidos pelos revendedores", C:"Serve só como espaço de confraternização", D:"Não tem importância, os revendedores não usam", correta:"B" },
      { p:"Qual é o papel do gerente de loja?", A:"Somente vender produtos", B:"Organizar o estoque sem liderança", C:"Liderar a equipe, acompanhar indicadores, garantir padronização da franquia e motivar o time", D:"Fazer limpeza da loja apenas", correta:"C" },
      { p:"Como se preparar para auditoria surpresa?", A:"Fazer faxina apenas na véspera", B:"Mantendo a rotina organizada todos os dias, como se a auditoria fosse acontecer a qualquer momento", C:"Arrumar só o estoque", D:"Esperar a auditoria para então organizar a loja", correta:"B" },
      { p:"Como o gerente atua na rotina com as consultoras?", A:"Faz reuniões de alinhamento, acompanha metas individuais e dá feedbacks para desenvolvimento", B:"Somente entrega produtos", C:"Observa a equipe sem dar retorno", D:"Aplica advertências diariamente", correta:"A" },
      { p:"Qual é a primeira atividade ao abrir a loja?", A:"Atender clientes imediatamente", B:"Realizar checklist de abertura: limpeza, planograma, conferência de caixa", C:"Conferir metas do mês anterior", D:"Organizar apenas a vitrine", correta:"B" },
      { p:"O que a auditoria verifica na loja?", A:"Somente os produtos da vitrine", B:"Apenas o caixa e estoque", C:"Planograma, vitrine, organização, atendimento, limpeza, estoque e cumprimento de padrões operacionais", D:"Atendimento aos clientes apenas", correta:"C" },
      { p:"Por que seguir o planograma é obrigatório?", A:"Porque ele deixa a loja mais bonita", B:"Porque orienta a exposição estratégica dos produtos e facilita a experiência do cliente", C:"Porque o gerente quer", D:"Porque é opcional, depende do dia", correta:"B" },
      { p:"O que é um indicador 'ofensor' no IAF?", A:"Indicador que já está superando a meta", B:"Indicador que está abaixo da meta e prejudica a performance", C:"Indicador que não tem relação com os resultados da equipe", D:"Indicador de meta batida", correta:"B" },
      { p:"Qual é o propósito central do IAF no Grupo Boticário?", A:"Ser apenas um sistema de acompanhamento de vendas", B:"Impulsionar performance, cultura de excelência e sustentabilidade do negócio", C:"Substituir totalmente o papel dos líderes na gestão das equipes", D:"Não faz diferença nas metas.", correta:"B" }
    ];

    /* ====== Estado/UI ====== */
    let dadosPessoa = {};
    let perguntaAtual = null;

    const efeitoTela = document.getElementById('efeitoTela');
    const fogos = document.getElementById('explosaoFogos');
    const optionsList = document.getElementById('optionsList');
    const msgResultado = document.getElementById('msgResultado');
    const btnVoltar = document.getElementById('btnVoltar');

    const nomeInput = document.getElementById('nome');
    const setorInput = document.getElementById('setor');
    const cidadeInput = document.getElementById('cidade');
    const formIdentificacao = document.getElementById('formIdentificacao');
    const telaPergunta = document.getElementById('telaPergunta');

    document.getElementById('btnIniciar').addEventListener('click', () => {
      const nome = nomeInput.value.trim();
      const setor = setorInput.value.trim();
      const cidade = cidadeInput.value.trim();
      if (!nome || !setor || !cidade) return alert('Preencha todos os campos.');
      dadosPessoa = { nome, setor, cidade };
      formIdentificacao.style.display = 'none';
      telaPergunta.style.display = 'block';
      sorteiaPergunta();
    });

    function montarAlternativas(pergunta) {
      const orig = ['A','B','C','D'];
      const itens = orig
        .map(L => ({ L, txt: pergunta[L] }))
        .filter(it => it.txt && String(it.txt).trim() !== '')
        .sort(() => Math.random() - 0.5);
      const rotulos = ['A','B','C','D'];
      optionsList.innerHTML = '';
      itens.forEach((it, idx) => {
        const li = document.createElement('li');
        li.textContent = `${rotulos[idx]}) ${it.txt}`;
        li.dataset.letra = it.L;          // letra ORIGINAL para checagem
        li.addEventListener('click', onOptionClick);
        optionsList.appendChild(li);
      });
    }

    function sorteiaPergunta() {
      perguntaAtual = perguntas[Math.floor(Math.random() * perguntas.length)];
      document.getElementById('perguntaTexto').textContent = perguntaAtual.p;
      montarAlternativas(perguntaAtual);
    }

    function onOptionClick(e) {
      const selecionada = e.currentTarget.dataset.letra;
      const correta = (perguntaAtual.correta || '').toUpperCase();
      const acertou = selecionada === correta;

      if (acertou) e.currentTarget.classList.add('correct');
      else e.currentTarget.classList.add('wrong');

      if (!acertou) {
        const corretaLi = [...optionsList.children].find(li => li.dataset.letra === correta);
        if (corretaLi) corretaLi.classList.add('correct');
      }

      msgResultado.textContent = acertou
        ? `Parabéns, ${dadosPessoa.nome}! Você pode rodar a roleta.`
        : `Não foi dessa vez, ${dadosPessoa.nome}.`;

      [...optionsList.children].forEach(li => li.removeEventListener('click', onOptionClick));
      btnVoltar.style.display = 'block';

      registraResultado(selecionada, correta, acertou);
      ativaEfeito(acertou ? 'fogos' : 'chuva');
    }

    function ativaEfeito(tipo) {
      if (tipo === 'fogos') {
        fogos.classList.add('ativo');
        setTimeout(() => fogos.classList.remove('ativo'), 3500);
      } else {
        efeitoTela.className = 'efeitoTela chuva ativo';
        setTimeout(() => efeitoTela.classList.remove('ativo'), 6000);
      }
    }

    /* ====== Envia para o Google Sheets + backup local ====== */
async function registraResultado(marcada, correta, acertou) {
  const agora = new Date();
  const registro = {
    Nome: dadosPessoa.nome,
    Setor: dadosPessoa.setor,
    Cidade: dadosPessoa.cidade,
    Pergunta: perguntaAtual.p,
    'Alternativa Correta': correta,
    'Alternativa Marcada': marcada,
    Resultado: acertou ? 'Acertou' : 'Errou',
    Data: agora.toLocaleDateString(),
    Hora: agora.toLocaleTimeString()
  };

  // 1) Backup local
  const registros = JSON.parse(localStorage.getItem('respostasQuiz') || '[]');
  registros.push(registro);
  localStorage.setItem('respostasQuiz', JSON.stringify(registros));

  // 2) Tenta enviar com sendBeacon (não sofre CORS)
  try {
    const payload = new Blob([JSON.stringify(registro)], { type: 'text/plain' });
    const ok = navigator.sendBeacon(SHEETS_WEBAPP_URL, payload);
    if (ok) {
      console.log('✔ Enviado ao Sheets via sendBeacon');
      return;
    }
  } catch (e) {
    console.warn('sendBeacon falhou, tentando fallback...', e);
  }

  // 3) Fallback via GET com querystring (sempre passa)
  try {
    const qs = new URLSearchParams();
    Object.entries(registro).forEach(([k,v]) => qs.append(k, v));
    // não precisamos ler a resposta
    fetch(`${SHEETS_WEBAPP_URL}?${qs.toString()}`, { method: 'GET', mode: 'no-cors' });
    console.log('✔ Enviado ao Sheets via GET fallback');
  } catch (e) {
    console.error('✖ Falha total ao enviar', e);
  }
}



    /* ====== Utilidades: baixar CSV local / limpar ====== */
    document.getElementById('btnDownload').addEventListener('click', () => {
      const registros = JSON.parse(localStorage.getItem('respostasQuiz') || '[]');
      if (!registros.length) return alert('Nenhum participante registrado localmente.');
      const cabe = Object.keys(registros[0]);
      const linhas = [cabe.join(';')].concat(
        registros.map(r => cabe.map(k => `"${String(r[k]).replaceAll('"','""')}"`).join(';'))
      );
      const csv = '\uFEFF' + linhas.join('\n');
      const blob = new Blob([csv], {type:'text/csv;charset=utf-8;'});
      const a = document.createElement('a'); a.href = URL.createObjectURL(blob);
      a.download = 'quiz-participantes.csv'; a.click(); URL.revokeObjectURL(a.href);
    });

    document.getElementById('btnLimpar').addEventListener('click', () => {
      if (!confirm('Tem certeza que deseja apagar os dados locais?')) return;
      localStorage.removeItem('respostasQuiz');
      alert('Dados locais apagados.');
    });

    btnVoltar.addEventListener('click', () => window.location.reload());
  </script>
</body>
</html>
